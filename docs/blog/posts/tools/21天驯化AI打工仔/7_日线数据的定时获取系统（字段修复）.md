# 21 å¤©é©¯åŒ– AI æ‰“å·¥ä»”ï¼šå¼€å‘é‡åŒ–äº¤æ˜“ç³»ç»Ÿ
## ï¼ˆä¸ƒï¼‰æ—¥çº¿æ•°æ®å®šæ—¶è·å–ç³»ç»Ÿçš„å­—æ®µä¿®å¤ä¸å®Œå–„

> æ•°æ®å¦‚åŒè¡€æ¶²ï¼Œå­—æ®µåˆ™æ˜¯è¡€å‹æ ‡è®°ã€‚æœ¬ç« å¸¦ä½ æ·±å…¥Aè‚¡æ•°æ®çš„"æ¶¨è·Œåœ"ä¸"ST"ä¸–ç•Œï¼Œè®©007åŠ©æ‰‹ä¸ºä½ æ­ç§˜å¦‚ä½•ç”¨Tushare APIå®Œç¾ä¿®å¤é‚£äº›ç¼ºå¤±çš„å…³é”®å­—æ®µï¼Œè®©é‡åŒ–ç­–ç•¥åœ¨çœŸå®å¸‚åœºç¯å¢ƒä¸­æ¸¸åˆƒæœ‰ä½™ï¼

## å‰è¨€
æ ¹æ®ä¸Šä¸€ç« èŠ‚ï¼Œæˆ‘ä»¬åŸºæœ¬å®ç°äº†æ—¥çº¿å®šæ—¶è·å–çš„åŸºæœ¬æ¶æ„ï¼Œä½†æ˜¯å…¶ä¸­æœ‰éƒ¨åˆ†å­—æ®µæ˜¯ä¸æ­£ç¡®çš„ï¼Œæˆ‘ä»¬ä»Šå¤©é‡ç‚¹æ¥å¯¹è¿™äº›å­—æ®µè¿›è¡Œä¿®å¤å’Œå®Œå–„......

![](https://images.jieyu.ai/images/2025/05/6_02.png)

"007ï¼Œæˆ‘ä»¬çš„æ—¥çº¿æ•°æ®å®šæ—¶è·å–ç³»ç»Ÿå·²ç»åŸºæœ¬æˆå‹ï¼Œä½†æ•°æ®å­—æ®µè¿˜ä¸å¤Ÿå®Œæ•´ï¼Œç‰¹åˆ«æ˜¯æ¶¨è·Œåœä»·æ ¼ã€STçŠ¶æ€å’Œå¤æƒå› å­è¿™äº›å…³é”®ä¿¡æ¯éƒ½ç¼ºå¤±äº†ã€‚"æˆ‘ä¸€è¾¹æŸ¥çœ‹ClickHouseä¸­çš„æ•°æ®ï¼Œä¸€è¾¹å¯¹æˆ‘çš„AIåŠ©æ‰‹è¯´é“ã€‚

"æ”¶åˆ°ğŸ«¡ï¼Œæˆ‘é©¬ä¸Šä¸ºæ‚¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚"007ç«‹åˆ»å›åº”é“ã€‚

è¿™æ˜¯æˆ‘ä»¬é‡åŒ–äº¤æ˜“ç³»ç»Ÿå¼€å‘çš„ç¬¬ä¸ƒå¤©ã€‚å‰å‡ å¤©ï¼Œæˆ‘ä»¬å·²ç»æ­å»ºäº†ä¸€ä¸ªèƒ½å¤Ÿå®šæ—¶ä»Tushareè·å–æ—¥çº¿æ•°æ®å¹¶å­˜å…¥ClickHouseçš„ç³»ç»Ÿã€‚ä½†åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°æ•°æ®ä¸­ç¼ºå°‘äº†å‡ ä¸ªå…³é”®å­—æ®µï¼Œè¿™äº›å­—æ®µå¯¹äºé‡åŒ–ç­–ç•¥çš„å¼€å‘è‡³å…³é‡è¦ã€‚

## é—®é¢˜åˆ†æï¼šç¼ºå¤±çš„å…³é”®å­—æ®µ

åœ¨é‡åŒ–äº¤æ˜“ä¸­ï¼Œæœ‰å‡ ä¸ªå­—æ®µå¯¹ç­–ç•¥åˆ¶å®šå’Œå›æµ‹è‡³å…³é‡è¦ï¼š

1. **æ¶¨è·Œåœä»·æ ¼ï¼ˆlimit_upå’Œlimit_downï¼‰**ï¼šAè‚¡å¸‚åœºæœ‰æ¶¨è·Œåœé™åˆ¶ï¼Œè¿™ç›´æ¥å½±å“äº†äº¤æ˜“ç­–ç•¥çš„æ‰§è¡Œã€‚å¦‚æœä¸çŸ¥é“æ¶¨è·Œåœä»·æ ¼ï¼Œå¯èƒ½ä¼šåˆ¶å®šå‡ºæ— æ³•æ‰§è¡Œçš„äº¤æ˜“è®¡åˆ’ã€‚

2. **STçŠ¶æ€ï¼ˆis_stï¼‰**ï¼šSTè‚¡ç¥¨æœ‰ç‰¹æ®Šçš„æ¶¨è·Œåœé™åˆ¶ï¼ˆÂ±5%è€ŒéÂ±10%ï¼‰ï¼Œä¸”é£é™©è¾ƒé«˜ï¼Œè®¸å¤šç­–ç•¥ä¼šé€‰æ‹©é¿å¼€STè‚¡ç¥¨ã€‚

3. **å¤æƒå› å­ï¼ˆadjustï¼‰**ï¼šå¯¹äºé•¿æœŸå›æµ‹ï¼Œæ­£ç¡®çš„å¤æƒå› å­æ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„å…³é”®ã€‚æ²¡æœ‰å¤æƒå› å­ï¼Œå°±æ— æ³•æ­£ç¡®å¤„ç†é™¤æƒé™¤æ¯å¯¹è‚¡ä»·çš„å½±å“ã€‚

æŸ¥çœ‹æˆ‘ä»¬ç°æœ‰çš„ä»£ç ï¼Œå‘ç°è¿™äº›å­—æ®µè¦ä¹ˆå®Œå…¨ç¼ºå¤±ï¼Œè¦ä¹ˆåªæ˜¯ç®€å•åœ°å¡«å……äº†é»˜è®¤å€¼ï¼š

```python
# æ·»åŠ æ¶¨è·Œåœå’ŒSTä¿¡æ¯
df['limit_up'] = None
df['limit_down'] = None
df['is_st'] = 0

# æ·»åŠ å¤æƒå› å­ï¼ˆè¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…åº”è¯¥ä»adj_factoræ¥å£è·å–ï¼‰
df['adjust'] = 1.0
```

è¿™æ˜¾ç„¶ä¸èƒ½æ»¡è¶³å®é™…éœ€æ±‚ã€‚æˆ‘ä»¬éœ€è¦ä»Tushareè·å–çœŸå®çš„æ•°æ®æ¥å¡«å……è¿™äº›å­—æ®µã€‚

## è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨Tushare APIè·å–å®Œæ•´å­—æ®µ

ç»è¿‡è®¨è®ºï¼Œæˆ‘å’Œ007å†³å®šä½¿ç”¨ä»¥ä¸‹Tushare APIæ¥è·å–ç¼ºå¤±çš„å­—æ®µï¼š

1. **stk_limit**ï¼šè·å–æ¶¨è·Œåœä»·æ ¼æ•°æ®
2. **namechange**ï¼šè·å–è‚¡ç¥¨åç§°å˜æ›´ä¿¡æ¯ï¼Œç”¨äºåˆ¤æ–­STçŠ¶æ€
3. **adj_factor**ï¼šè·å–å¤æƒå› å­æ•°æ®

### 1. è·å–æ¶¨è·Œåœä»·æ ¼

æ¶¨è·Œåœä»·æ ¼æ˜¯äº¤æ˜“ç­–ç•¥ä¸­çš„é‡è¦å‚è€ƒç‚¹ã€‚åœ¨Aè‚¡å¸‚åœºï¼Œæ™®é€šè‚¡ç¥¨çš„æ¶¨è·Œå¹…é™åˆ¶ä¸ºÂ±10%ï¼ŒSTè‚¡ç¥¨ä¸ºÂ±5%ï¼Œç§‘åˆ›æ¿å’Œåˆ›ä¸šæ¿ä¸ºÂ±20%ã€‚æˆ‘ä»¬éœ€è¦ä»Tushareçš„`stk_limit`æ¥å£è·å–è¿™äº›æ•°æ®ã€‚

007ä¿®æ”¹äº†`_enrich_daily_data`æ–¹æ³•ï¼Œæ·»åŠ äº†è·å–æ¶¨è·Œåœä»·æ ¼çš„ä»£ç ï¼š

```python
# è·å–æ¶¨è·Œåœä»·æ ¼
limit_df = self._call_tushare_api(
    api_name='stk_limit',
    params={'trade_date': trade_date},
    fields='ts_code,trade_date,up_limit,down_limit'
)

# æ·»åŠ æ¶¨è·Œåœä¿¡æ¯
if not limit_df.empty:
    # åˆå¹¶æ¶¨è·Œåœä¿¡æ¯
    df = pd.merge(df, limit_df[['ts_code', 'up_limit', 'down_limit']],
                 on='ts_code', how='left')
else:
    # å¦‚æœæ²¡æœ‰æ¶¨è·Œåœæ•°æ®ï¼Œåˆ™æ·»åŠ ç©ºåˆ—
    df['up_limit'] = None
    df['down_limit'] = None
```

è¿™æ®µä»£ç é¦–å…ˆè°ƒç”¨Tushareçš„`stk_limit`æ¥å£è·å–æŒ‡å®šäº¤æ˜“æ—¥çš„æ¶¨è·Œåœä»·æ ¼æ•°æ®ï¼Œç„¶åé€šè¿‡`pd.merge`å°†è¿™äº›æ•°æ®ä¸åŸå§‹æ—¥çº¿æ•°æ®åˆå¹¶ã€‚å¦‚æœè·å–å¤±è´¥æˆ–æ•°æ®ä¸ºç©ºï¼Œåˆ™æ·»åŠ ç©ºåˆ—ä½œä¸ºå ä½ç¬¦ã€‚

### 2. åˆ¤æ–­STçŠ¶æ€

STï¼ˆSpecial Treatmentï¼‰æ˜¯å¯¹å­˜åœ¨è´¢åŠ¡é—®é¢˜æˆ–å…¶ä»–é£é™©çš„ä¸Šå¸‚å…¬å¸çš„ç‰¹æ®Šå¤„ç†ã€‚STè‚¡ç¥¨æœ‰æ›´ä¸¥æ ¼çš„æ¶¨è·Œå¹…é™åˆ¶ï¼Œä¸”é£é™©è¾ƒé«˜ï¼Œå› æ­¤åœ¨é‡åŒ–ç­–ç•¥ä¸­é€šå¸¸éœ€è¦ç‰¹åˆ«å¯¹å¾…ã€‚

åˆ¤æ–­ä¸€åªè‚¡ç¥¨æ˜¯å¦ä¸ºSTè‚¡ç¥¨å¹¶ä¸æ˜¯ç®€å•åœ°æŸ¥è¯¢ä¸€ä¸ªæ¥å£å°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡è‚¡ç¥¨åç§°å˜æ›´è®°å½•æ¥åˆ¤æ–­ã€‚å¦‚æœè‚¡ç¥¨åç§°ä¸­åŒ…å«"ST"ï¼Œä¸”å½“å‰æ—¥æœŸåœ¨STå¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸä¹‹é—´ï¼Œåˆ™è¯¥è‚¡ç¥¨åœ¨å½“å‰æ—¥æœŸä¸ºSTè‚¡ç¥¨ã€‚

007å®ç°äº†ä¸€ä¸ªå¤æ‚ä½†é«˜æ•ˆçš„STçŠ¶æ€åˆ¤æ–­é€»è¾‘ï¼š

```python
# è·å–STè‚¡ç¥¨ä¿¡æ¯
namechange_df = self._call_tushare_api(
    api_name='namechange',
    params={},
    fields='ts_code,name,start_date,end_date,change_reason'
)

# å¤„ç†STä¿¡æ¯
st_codes = []
if not namechange_df.empty:
    # ç­›é€‰å‡ºåç§°ä¸­åŒ…å«STçš„è‚¡ç¥¨
    st_df = namechange_df[namechange_df['name'].str.contains('ST', na=False)]

    # æ£€æŸ¥æ¯ä¸ªè‚¡ç¥¨åœ¨å½“å‰æ—¥æœŸæ˜¯å¦ä¸ºST
    for _, row in st_df.iterrows():
        ts_code = row['ts_code']
        start_date_str = row['start_date']
        end_date_str = row['end_date']

        # è½¬æ¢æ—¥æœŸæ ¼å¼
        start_date = datetime.datetime.strptime(start_date_str, '%Y%m%d')
        target_date = datetime.datetime.strptime(trade_date, '%Y%m%d')

        # å¤„ç†ç»“æŸæ—¥æœŸ
        if pd.isna(end_date_str) or end_date_str is None:
            end_date = datetime.datetime.now()
        else:
            end_date = datetime.datetime.strptime(end_date_str, '%Y%m%d')

        # åˆ¤æ–­å½“å‰æ—¥æœŸæ˜¯å¦åœ¨STæ—¥æœŸèŒƒå›´å†…
        if (target_date - start_date).days >= 0 and (target_date - end_date).days <= 0:
            st_codes.append(ts_code)
            logger.debug(f"è‚¡ç¥¨ {ts_code} åœ¨ {trade_date} ä¸ºSTè‚¡ç¥¨")

# æ·»åŠ STæ ‡å¿—
df['is_st'] = df['ts_code'].isin(st_codes).astype(int)
```

è¿™æ®µä»£ç é¦–å…ˆè·å–æ‰€æœ‰è‚¡ç¥¨çš„åç§°å˜æ›´è®°å½•ï¼Œç„¶åç­›é€‰å‡ºåç§°ä¸­åŒ…å«"ST"çš„è®°å½•ã€‚å¯¹äºæ¯æ¡è®°å½•ï¼Œæ£€æŸ¥ç›®æ ‡æ—¥æœŸæ˜¯å¦åœ¨STå¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸä¹‹é—´ã€‚å¦‚æœæ˜¯ï¼Œåˆ™å°†è¯¥è‚¡ç¥¨æ·»åŠ åˆ°STè‚¡ç¥¨åˆ—è¡¨ä¸­ã€‚æœ€åï¼Œé€šè¿‡æ£€æŸ¥æ¯åªè‚¡ç¥¨æ˜¯å¦åœ¨STè‚¡ç¥¨åˆ—è¡¨ä¸­ï¼Œä¸ºåŸå§‹æ•°æ®æ·»åŠ `is_st`å­—æ®µï¼Œå€¼ä¸º0æˆ–1ã€‚

### 3. è·å–å¤æƒå› å­

å¤æƒå› å­æ˜¯å¤„ç†è‚¡ç¥¨é™¤æƒé™¤æ¯çš„å…³é”®ã€‚åœ¨Aè‚¡å¸‚åœºï¼Œä¸Šå¸‚å…¬å¸åˆ†çº¢é€è‚¡ä¼šå¯¼è‡´è‚¡ä»·å˜åŠ¨ï¼Œä½¿å¾—å†å²æ•°æ®ä¸è¿ç»­ã€‚é€šè¿‡å¤æƒå› å­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å†å²ä»·æ ¼è°ƒæ•´ä¸ºè¿ç»­çš„åºåˆ—ï¼Œä¾¿äºåˆ†æå’Œå›æµ‹ã€‚

007æ·»åŠ äº†è·å–å¤æƒå› å­çš„ä»£ç ï¼š

```python
# è·å–å¤æƒå› å­
adj_factor_df = self._call_tushare_api(
    api_name='adj_factor',
    params={'trade_date': trade_date},
    fields='ts_code,trade_date,adj_factor'
)

# æ·»åŠ å¤æƒå› å­
if not adj_factor_df.empty:
    # åˆå¹¶å¤æƒå› å­ä¿¡æ¯
    df = pd.merge(df, adj_factor_df[['ts_code', 'adj_factor']],
                 on='ts_code', how='left')
    # å°†ç¼ºå¤±å€¼å¡«å……ä¸º1.0
    df['adj_factor'] = df['adj_factor'].fillna(1.0)
else:
    # å¦‚æœæ²¡æœ‰å¤æƒå› å­æ•°æ®ï¼Œåˆ™æ·»åŠ é»˜è®¤å€¼
    df['adj_factor'] = 1.0

# é‡å‘½åadj_factorä¸ºadjust
df = df.rename(columns={'adj_factor': 'adjust'})
```

è¿™æ®µä»£ç è°ƒç”¨Tushareçš„`adj_factor`æ¥å£è·å–å¤æƒå› å­æ•°æ®ï¼Œç„¶åé€šè¿‡`pd.merge`å°†è¿™äº›æ•°æ®ä¸åŸå§‹æ—¥çº¿æ•°æ®åˆå¹¶ã€‚å¯¹äºç¼ºå¤±çš„å¤æƒå› å­ï¼Œå¡«å……é»˜è®¤å€¼1.0ï¼ˆè¡¨ç¤ºä¸éœ€è¦å¤æƒï¼‰ã€‚æœ€åï¼Œå°†åˆ—åä»`adj_factor`é‡å‘½åä¸º`adjust`ï¼Œä»¥ç¬¦åˆæˆ‘ä»¬çš„æ•°æ®åº“ç»“æ„ã€‚

## å¤„ç†å†å²æ•°æ®çš„ç‰¹æ®ŠæŒ‘æˆ˜

å¯¹äºå½“æ—¥æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è·å–å½“æ—¥çš„æ¶¨è·Œåœä»·æ ¼ã€STçŠ¶æ€å’Œå¤æƒå› å­ã€‚ä½†å¯¹äºå†å²æ•°æ®ï¼Œæƒ…å†µä¼šæ›´å¤æ‚ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å¤„ç†ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ã€‚

007ä¸ºå†å²æ•°æ®è®¾è®¡äº†æ›´é«˜æ•ˆçš„å¤„ç†æ–¹æ³•ï¼š

```python
# å°†æ¶¨è·Œåœä¿¡æ¯è½¬æ¢ä¸ºå­—å…¸ï¼Œæ–¹ä¾¿æŸ¥æ‰¾
limit_info = {}
for _, row in limit_df.iterrows():
    ts_code = row['ts_code']
    trade_date = row['trade_date']
    key = f"{ts_code}_{trade_date}"
    limit_info[key] = {
        'up_limit': row['up_limit'],
        'down_limit': row['down_limit']
    }

# æ·»åŠ æ¶¨è·Œåœå’ŒSTä¿¡æ¯
df['limit_up'] = None
df['limit_down'] = None
df['is_st'] = 0

for i, row in df.iterrows():
    ts_code = row['ts_code']
    trade_date = row['trade_date']
    key = f"{ts_code}_{trade_date}"

    # æ·»åŠ æ¶¨è·Œåœä¿¡æ¯
    if key in limit_info:
        df.at[i, 'limit_up'] = limit_info[key]['up_limit']
        df.at[i, 'limit_down'] = limit_info[key]['down_limit']

    # æ·»åŠ STä¿¡æ¯
    if key in st_info:
        df.at[i, 'is_st'] = st_info[key]
```

è¿™ç§æ–¹æ³•é¦–å…ˆå°†æ¶¨è·Œåœä¿¡æ¯å’ŒSTä¿¡æ¯è½¬æ¢ä¸ºå­—å…¸ï¼Œé”®ä¸ºè‚¡ç¥¨ä»£ç å’Œäº¤æ˜“æ—¥æœŸçš„ç»„åˆï¼Œå€¼ä¸ºå¯¹åº”çš„æ•°æ®ã€‚ç„¶åéå†åŸå§‹æ•°æ®çš„æ¯ä¸€è¡Œï¼Œæ ¹æ®è‚¡ç¥¨ä»£ç å’Œäº¤æ˜“æ—¥æœŸæ„å»ºé”®ï¼Œä»å­—å…¸ä¸­æŸ¥æ‰¾å¯¹åº”çš„æ•°æ®ã€‚è¿™ç§æ–¹æ³•æ¯”ç›´æ¥ä½¿ç”¨`pd.merge`æ›´çµæ´»ï¼Œå¯ä»¥å¤„ç†æ›´å¤æ‚çš„æƒ…å†µã€‚

å¯¹äºå¤æƒå› å­ï¼Œä¹Ÿé‡‡ç”¨äº†ç±»ä¼¼çš„æ–¹æ³•ï¼š

```python
# å°†å¤æƒå› å­ä¿¡æ¯è½¬æ¢ä¸ºå­—å…¸ï¼Œæ–¹ä¾¿æŸ¥æ‰¾
adj_factor_info = {}
for _, row in adj_factor_df.iterrows():
    ts_code = row['ts_code']
    trade_date = row['trade_date']
    key = f"{ts_code}_{trade_date}"
    adj_factor_info[key] = row['adj_factor']

# ä¸ºæ¯æ¡è®°å½•æ·»åŠ å¤æƒå› å­
df['adjust'] = 1.0  # é»˜è®¤å€¼
for i, row in df.iterrows():
    ts_code = row['ts_code']
    trade_date = row['trade_date']
    key = f"{ts_code}_{trade_date}"

    # æ·»åŠ å¤æƒå› å­ä¿¡æ¯
    if key in adj_factor_info:
        df.at[i, 'adjust'] = adj_factor_info[key]
```

## ä¼˜åŒ–APIè°ƒç”¨ï¼šç›´æ¥ä½¿ç”¨Tushareåº“

åœ¨å®ç°è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°ä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼šæœ€åˆçš„ä»£ç å°è¯•é€šè¿‡HTTPè¯·æ±‚ç›´æ¥è°ƒç”¨Tushare APIï¼Œè¿™ä¸ä»…æ•ˆç‡ä½ï¼Œè¿˜å¯èƒ½å¯¼è‡´å„ç§ç½‘ç»œé—®é¢˜ã€‚

"007ï¼Œæˆ‘ä»¬åº”è¯¥ç›´æ¥ä½¿ç”¨Tushareåº“è¿›è¡Œæ•°æ®è·å–ï¼Œè€Œä¸æ˜¯é€šè¿‡HTTPè¯·æ±‚ã€‚"æˆ‘æé†’é“ã€‚

"æ”¶åˆ°ğŸ«¡ï¼Œæˆ‘é©¬ä¸Šä¿®æ”¹ä»£ç ã€‚"007è¿…é€Ÿå“åº”ã€‚

ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹ï¼š

```python
# åˆå§‹åŒ–Tushare API
ts.set_token(self.token)
self.pro = ts.pro_api()  # ä¸å†ä¼ å…¥api_urlå‚æ•°
```

è¿™ç§æ–¹å¼ç›´æ¥ä½¿ç”¨Tushareå®˜æ–¹åº“çš„APIï¼Œä¸ä»…ä»£ç æ›´ç®€æ´ï¼Œè€Œä¸”æ›´å¯é ï¼Œé¿å…äº†HTTPè¯·æ±‚å¯èƒ½å¸¦æ¥çš„å„ç§é—®é¢˜ã€‚

## æµ‹è¯•ä¸éªŒè¯

å®Œæˆä»£ç ä¿®æ”¹åï¼Œæˆ‘ä»¬è¿›è¡Œäº†æµ‹è¯•ï¼Œç¡®ä¿æ–°æ·»åŠ çš„å­—æ®µèƒ½å¤Ÿæ­£ç¡®è·å–å’Œå­˜å‚¨ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬è·å–å½“æ—¥æ•°æ®ï¼š

```bash
python main.py daily --batch-size 1000
```

ç„¶åï¼Œæˆ‘ä»¬è·å–å†å²æ•°æ®ï¼š

```bash
python main.py history --days 7 --batch-size 1000
```

æœ€åï¼Œæˆ‘ä»¬æ£€æŸ¥ClickHouseä¸­çš„æ•°æ®ï¼š

```bash
python main.py info
```

```
2025-05-22 17:10:24,352 - day_bar_fetcher - INFO - Tushare APIåˆå§‹åŒ–æˆåŠŸ
2025-05-22 17:10:24,393 - day_bar_fetcher - INFO - Redisè¿æ¥æˆåŠŸ
2025-05-22 17:10:24,538 - day_bar_fetcher - INFO - ClickHouseè¿æ¥æˆåŠŸ
2025-05-22 17:10:24,554 - day_bar_fetcher - INFO - å·²ç¡®ä¿è¡¨ RealTime_DailyLine_DB.day_bar å­˜åœ¨
2025-05-22 17:10:24,555 - day_bar_fetcher - INFO - è°ƒåº¦å™¨åˆå§‹åŒ–æˆåŠŸ
2025-05-22 17:10:24,585 - day_bar_fetcher - INFO - ==================================================
2025-05-22 17:10:24,585 - day_bar_fetcher - INFO - ClickHouseä¸­å·²æœ‰æ•°æ®çš„æ—¶é—´èŒƒå›´: 20250515 - 20250521
2025-05-22 17:10:24,588 - day_bar_fetcher - INFO - ClickHouseä¸­å…±æœ‰ 26953 æ¡æ•°æ®è®°å½•
2025-05-22 17:10:24,588 - day_bar_fetcher - INFO - ==================================================
```

![](https://images.jieyu.ai/images/2025/05/7_01.png)

æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼Œæ‰€æœ‰å­—æ®µéƒ½å·²æ­£ç¡®è·å–å’Œå­˜å‚¨ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¶¨è·Œåœä»·æ ¼ã€STçŠ¶æ€å’Œå¤æƒå› å­è¿™äº›å…³é”®å­—æ®µéƒ½å·²ç»å¡«å……äº†çœŸå®çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ç®€å•çš„é»˜è®¤å€¼ã€‚

## æˆæœä¸æ€è€ƒ

é€šè¿‡è¿™æ¬¡å­—æ®µä¿®å¤ï¼Œæˆ‘ä»¬çš„æ—¥çº¿æ•°æ®å®šæ—¶è·å–ç³»ç»Ÿå˜å¾—æ›´åŠ å®Œå–„å’Œå®ç”¨ã€‚ç°åœ¨ï¼Œç³»ç»Ÿå¯ä»¥è·å–å¹¶å­˜å‚¨ä»¥ä¸‹å…³é”®å­—æ®µï¼š

- åŸºæœ¬OHLCæ•°æ®ï¼šå¼€ç›˜ä»·ã€æœ€é«˜ä»·ã€æœ€ä½ä»·ã€æ”¶ç›˜ä»·ã€æˆäº¤é‡ã€æˆäº¤é¢
- æ¶¨è·Œåœä»·æ ¼ï¼šä¸Šæ¶¨é™åˆ¶ä»·æ ¼ã€ä¸‹è·Œé™åˆ¶ä»·æ ¼
- STçŠ¶æ€ï¼šæ˜¯å¦ä¸ºSTè‚¡ç¥¨
- å¤æƒå› å­ï¼šç”¨äºå‰å¤æƒæˆ–åå¤æƒè®¡ç®—

è¿™äº›å­—æ®µä¸ºåç»­çš„é‡åŒ–ç­–ç•¥å¼€å‘æä¾›äº†åšå®çš„æ•°æ®åŸºç¡€ã€‚ç‰¹åˆ«æ˜¯ï¼Œæœ‰äº†æ­£ç¡®çš„æ¶¨è·Œåœä»·æ ¼å’ŒSTçŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å‡†ç¡®åœ°æ¨¡æ‹Ÿå®é™…äº¤æ˜“ç¯å¢ƒï¼›æœ‰äº†å¤æƒå› å­ï¼Œæˆ‘ä»¬å¯ä»¥æ­£ç¡®å¤„ç†å†å²æ•°æ®çš„è¿ç»­æ€§é—®é¢˜ã€‚

"007ï¼Œä½ åšå¾—å¾ˆå¥½ï¼è¿™æ¬¡çš„å­—æ®µä¿®å¤è®©æˆ‘ä»¬çš„ç³»ç»Ÿæ›´åŠ å®Œå–„äº†ã€‚"æˆ‘ç”±è¡·åœ°èµèµé“ã€‚

## ä¸‹ä¸€æ­¥è®¡åˆ’

å®Œæˆå­—æ®µä¿®å¤åï¼Œæˆ‘ä»¬çš„æ—¥çº¿æ•°æ®å®šæ—¶è·å–ç³»ç»Ÿå·²ç»ç›¸å½“å®Œå–„ã€‚ä½†åœ¨é‡åŒ–äº¤æ˜“ç³»ç»Ÿçš„å¼€å‘é“è·¯ä¸Šï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¡åˆ’ï¼š

1. **ç³»ç»Ÿç¨³å®šæ€§æµ‹è¯•**ï¼šåœ¨å®é™…ç¯å¢ƒä¸­é•¿æœŸè¿è¡Œç³»ç»Ÿï¼Œç¡®ä¿å…¶ç¨³å®šæ€§å’Œå¯é æ€§ã€‚
2. **æ•°æ®è´¨é‡ç›‘æ§**ï¼šå¼€å‘ç›‘æ§å·¥å…·ï¼Œå®æ—¶æ£€æŸ¥æ•°æ®çš„å®Œæ•´æ€§å’Œå‡†ç¡®æ€§ã€‚
3. **æ‰©å±•æ•°æ®æº**ï¼šé™¤äº†æ—¥çº¿æ•°æ®ï¼Œè¿˜å¯ä»¥è€ƒè™‘æ·»åŠ åˆ†é’Ÿçº¿ã€tickæ•°æ®ç­‰æ›´ç»†ç²’åº¦çš„æ•°æ®ã€‚
4. **ç­–ç•¥å›æµ‹æ¨¡å—**ï¼šå¼€å‘ç­–ç•¥å›æµ‹æ¨¡å—ï¼Œåˆ©ç”¨å·²è·å–çš„æ•°æ®è¿›è¡Œç­–ç•¥å›æµ‹ã€‚

è¿™äº›è®¡åˆ’å°†åœ¨æ¥ä¸‹æ¥çš„æ—¥å­é‡Œé€æ­¥å®æ–½ã€‚æˆ‘ç›¸ä¿¡ï¼Œåœ¨007çš„ååŠ©ä¸‹ï¼Œæˆ‘ä»¬çš„é‡åŒ–äº¤æ˜“ç³»ç»Ÿå°†ä¼šè¶Šæ¥è¶Šå¼ºå¤§ã€‚

21å¤©çš„æŒ‘æˆ˜ä»åœ¨ç»§ç»­ï¼ŒæœŸå¾…æ›´å¤šçš„çªç ´å’Œæˆæœï¼